(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[493],{6431:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/contribute",function(){return n(7326)}])},5843:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var r=n(5893),s=n(4298),a=n(7294),o=n(4040),i=n(4525),c=n.n(i);function u(e){var t=(0,a.useState)(!1),n=t[0],i=t[1],u=(0,a.useCallback)((function(){return i(!0)}),[]);return(0,a.useEffect)((function(){"google"in window&&u()}),[u]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.default,{src:"https://accounts.google.com/gsi/client",onLoad:u,onError:console.error}),n?e.page:(0,r.jsx)("div",{className:c().load,children:(0,r.jsx)(o.SyncLoader,{})})]})}},6673:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(5893),s=n(3952),a=n.n(s);function o(e){return(0,r.jsx)("footer",{className:e.isDark?"".concat(a().footer," ").concat(a().dark):a().footer,children:(0,r.jsx)("a",{href:"https://www.flaticon.com/free-icons/roller-coaster",title:"roller coaster icons",children:"Roller coaster icons created by Freepik - Flaticon"})})}},1952:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var r=n(5893),s=n(1664),a=n(9929),o=n(9988),i=n(5606),c=n.n(i);function u(){return(0,r.jsxs)("header",{className:c().header,children:[(0,r.jsx)("h1",{className:c().h1,children:(0,r.jsx)(s.default,{href:"/",children:(0,r.jsxs)("a",{className:c().a,children:[(0,r.jsx)("img",{src:"/img/icon.png",alt:"",className:c().img}),a.sG]})})}),(0,r.jsx)("div",{className:c().div,children:(0,r.jsx)(o.Z,{})})]})}},9988:function(e,t,n){"use strict";n.d(t,{Z:function(){return p}});var r=n(4051),s=n.n(r),a=n(5893),o=n(1664),i=n(7294),c=n(4040),u=n(3253),l=n.n(u),d=n(606),h=n(9929);function f(e,t,n,r,s,a,o){try{var i=e[a](o),c=i.value}catch(u){return void n(u)}i.done?t(c):Promise.resolve(c).then(r,s)}function p(){var e=(0,i.useState)(""),t=e[0],n=e[1],r=(0,i.useState)(null),u=r[0],p=r[1],m=(0,i.useState)({s:"hidden"}),x=m[0],v=m[1],g=(0,i.useCallback)(function(){var e,t=(e=s().mark((function e(t){var n,r,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(p(null),""!==(n=t.replace(/[\W_]+/g,"").toLowerCase())){e.next=5;break}return v({s:"hidden"}),e.abrupt("return");case 5:return e.next=7,fetch("".concat(h.QP,"Search?q=").concat(n));case 7:if((r=e.sent).ok){e.next=11;break}return v({s:"hidden"}),e.abrupt("return");case 11:return e.next=13,r.json();case 13:a=e.sent,v({s:"displayed",list:a});case 15:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,s){var a=e.apply(t,n);function o(e){f(a,r,s,o,i,"next",e)}function i(e){f(a,r,s,o,i,"throw",e)}o(void 0)}))});return function(e){return t.apply(this,arguments)}}(),[v,p]),j=(0,i.useCallback)((function(){n(""),v({s:"hidden"})}),[]),b=(0,i.useCallback)((function(e){var t=e.target.value;n(t),u&&window.clearTimeout(u),""!==t.replace(/[\W_]+/g,"").toLowerCase()?(v({s:"loading"}),p(window.setTimeout((function(){g(t)}),1e3))):v({s:"hidden"})}),[n,u,p,g]),w=(0,i.useCallback)((function(){var e=(0,a.jsxs)("span",{className:l().prompt,children:["Don't see a coaster? ",(0,a.jsx)("a",{href:"/contribute/newCoaster",children:"Add it!"})]});switch(x.s){case"hidden":return null;case"loading":return(0,a.jsx)("div",{className:l().results,children:(0,a.jsx)("span",{className:l().load,children:(0,a.jsx)(c.SyncLoader,{color:"white",size:5})})});case"displayed":return 0===x.list.length?(0,a.jsxs)("div",{className:l().results,children:[(0,a.jsx)("span",{className:l().noResults,children:"No results found"})," ",e]}):(0,a.jsxs)("div",{className:l().results,children:[(0,a.jsx)("ul",{children:x.list.map((function(e){return(0,a.jsx)("li",{children:(0,a.jsx)(o.default,{href:"/results?id=".concat(e.id),children:(0,a.jsxs)("a",{onClick:j,children:[(0,a.jsx)("p",{children:e.name}),(0,a.jsx)("p",{children:e.park})]})})},e.id)}))}),e]});default:return(0,d.U)(x)}}),[x,j]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("input",{type:"text",placeholder:"Search for a coaster",value:t,onChange:b,className:l().input}),w()]})}},6132:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(5893),s=n(6934),a=n.n(s);function o(e){var t=Array.from(Array(e.rows).keys()),n=Array.from(Array(e.cols).keys());return(0,r.jsxs)("section",{className:a().coaster,children:[(0,r.jsx)("p",{children:"Front of train"}),(0,r.jsx)("table",{className:a().coasterTrain,children:(0,r.jsx)("tbody",{children:t.map((function(t){return(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:t+1}),n.map((function(n){return(0,r.jsx)("td",{children:e.render(t,n)},n)}))]},t)}))})})]})}},7326:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return I}});var r=n(4051),s=n.n(r),a=n(5893),o=n(9008),i=n(7294),c=n(4040),u=n(1664),l=n(1163);function d(e){this.message=e}d.prototype=new Error,d.prototype.name="InvalidCharacterError";var h="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(e){var t=String(e).replace(/=+$/,"");if(t.length%4==1)throw new d("'atob' failed: The string to be decoded is not correctly encoded.");for(var n,r,s=0,a=0,o="";r=t.charAt(a++);~r&&(n=s%4?64*n+r:r,s++%4)?o+=String.fromCharCode(255&n>>(-2*s&6)):0)r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(r);return o};function f(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}try{return function(e){return decodeURIComponent(h(e).replace(/(.)/g,(function(e,t){var n=t.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n})))}(t)}catch(e){return h(t)}}function p(e){this.message=e}p.prototype=new Error,p.prototype.name="InvalidTokenError";var m=function(e,t){if("string"!=typeof e)throw new p("Invalid token specified");var n=!0===(t=t||{}).header?0:1;try{return JSON.parse(f(e.split(".")[n]))}catch(e){throw new p("Invalid token specified: "+e.message)}},x=n(6673),v=n(1952),g=n(606),j=n(9929),b=n(2746),w=n.n(b),_=n(9841),k=n.n(_),y=n(6132),N=n(2601),C=n(5843);function S(e,t,n,r,s,a,o){try{var i=e[a](o),c=i.value}catch(u){return void n(u)}i.done?t(c):Promise.resolve(c).then(r,s)}function E(e){return function(){var t=this,n=arguments;return new Promise((function(r,s){var a=e.apply(t,n);function o(e){S(a,r,s,o,i,"next",e)}function i(e){S(a,r,s,o,i,"throw",e)}o(void 0)}))}}function T(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function A(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){T(e,t,n[t])}))}return e}function O(){var e=(0,i.useState)({s:"Unauthenticated"}),t=e[0],n=e[1],r=(0,i.useCallback)((function(){window.document.title="N/A - ".concat(j.sG),n({s:"Not Found"})}),[]),o=(0,i.useCallback)((function(e){"Ready"===t.s&&n(A({},t,{step:e}))}),[t]),d=(0,l.useRouter)(),h=d.query.id,f=d.isReady,p=(0,i.useCallback)((function(e){var t=e.credential;(0,N.W)(t),n({s:"Loading",token:t})}),[]);(0,i.useEffect)((function(){switch(t.s){case"Unauthenticated":var e=(0,N.v)();if(null!==e)return void n({s:"Loading",token:e});google.accounts.id.initialize({client_id:j.Cx,callback:p}),google.accounts.id.renderButton(document.getElementById("gbuttonDiv"),{theme:"outline",size:"large"});break;case"Loading":var a=function(){var e=E(s().mark((function e(){var a,o,i,c;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(f){e.next=2;break}return e.abrupt("return");case 2:if(void 0!==h&&!Array.isArray(h)){e.next=5;break}return r(),e.abrupt("return");case 5:return e.next=7,fetch("".concat(j.QP,"GetCoaster?id=").concat(h));case 7:if((a=e.sent).ok){e.next=11;break}return r(),e.abrupt("return");case 11:return e.next=13,a.json();case 13:o=e.sent,i=Array.from(Array(o.rows).keys()),c=Array.from(Array(o.cols).keys()),n({s:"Ready",token:t.token,id:o.id,name:o.name,park:o.park,rows:o.rows,cols:o.cols,selected:i.map((function(){return c.map((function(){}))})),step:1,submitting:!1});case 17:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();a()}}),[t,p,h,r,f]);var x=(0,i.useCallback)((function(e,r,s){if("Ready"!==t.s)throw new Error;var a=t.selected.slice();a[e]=t.selected[e].slice(),a[e][r]=s,n(A({},t,{selected:a}))}),[t]),v=(0,i.useMemo)((function(){if("Ready"!==t.s)return["",""];switch(t.step){case 1:return["Step 1: Select the seats you love","You just walked into an empty station and the op lets you pick your row."];case 2:return["Step 2: Select the seats you like","Your preferred seat is taken but you don't want to wait."];case 3:return["Step 3: Select the seats you hate","You'd leave the line before sitting here."];default:return(0,g.U)(t.step)}}),[t]),b=(0,i.useCallback)((function(){"Ready"===t.s&&(t.submitting||(n(A({},t,{submitting:!0})),E(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(j.QP,"Vote?id=").concat(t.id,"&uid=").concat(m(t.token).sub),{method:"POST",body:JSON.stringify({token:t.token,votes:t.selected.map((function(e){return e.map((function(e){return void 0===e?null:e}))}))})});case 2:e.sent.ok?n({s:"Done",id:t.id}):n({s:"Error"});case 4:case"end":return e.stop()}}),e)})))()))}),[t]),_=(0,i.useCallback)((function(){return location.reload()}),[]);return(0,i.useCallback)((function(){switch(t.s){case"Unauthenticated":return(0,a.jsxs)("div",{className:w().load,children:[(0,a.jsx)("h1",{children:"Sign In"}),(0,a.jsx)("div",{id:"gbuttonDiv",className:w().signInBtn}),(0,a.jsx)("p",{children:"This is my attempt to stop the same person from spamming multiple reviews on the same ride. I don't track anything from your Google account. If you have a better idea for how to do this, suggestions are welcome."})]});case"Loading":return(0,a.jsx)("div",{className:w().load,children:(0,a.jsx)(c.SyncLoader,{})});case"Not Found":return(0,a.jsxs)("div",{className:w().load,children:[(0,a.jsx)("h1",{children:"Coaster Not Found :("}),(0,a.jsx)(u.default,{href:"/contribute/newCoaster",children:(0,a.jsx)("a",{className:k().bigBtn,children:"Why not add it?"})})]});case"Ready":return(0,a.jsxs)("main",{className:w().main,children:[(0,a.jsx)("h1",{children:t.name}),(0,a.jsx)("h2",{children:t.park}),(0,a.jsx)(y.Z,{rows:t.rows,cols:t.cols,render:function(e,n){if(void 0===t.selected[e][n]||t.selected[e][n]===t.step)return(0,a.jsx)("input",{type:"checkbox",checked:t.selected[e][n]===t.step,onChange:function(r){return x(e,n,r.target.checked?t.step:void 0)}});switch(t.selected[e][n]){case 1:return"\ud83d\udfe2";case 2:return"\u2795";case 3:return"\u26d4";default:throw new Error}}}),(0,a.jsxs)("section",{className:w().details,children:[(0,a.jsx)("div",{className:w().progress,children:[1,2,3].map((function(e){return(0,a.jsx)("span",{className:t.step===e?w().active:"",children:e},e)}))}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{children:v[0]}),(0,a.jsx)("p",{children:v[1]})]}),(0,a.jsxs)("div",{className:w().subInstr,children:[(0,a.jsx)("p",{children:"Select as many or as few seats as you want."}),(0,a.jsx)("p",{children:"If you haven't ridden in, have no opinion on, or just don't care about a seat, leave it unchecked."}),(0,a.jsx)("p",{children:"If you previously voted on this coaster, your prior vote will be replaced."})]}),(0,a.jsxs)("div",{children:[1===t.step?null:(0,a.jsx)("button",{className:k().bigBtn,onClick:function(){return o(t.step-1)},children:"Back"})," ",3===t.step?null:(0,a.jsx)("button",{className:k().bigBtn,onClick:function(){return o(t.step+1)},children:"Next"})," ",3!==t.step?null:(0,a.jsx)("button",{className:k().bigBtn,disabled:t.submitting,onClick:b,children:"Submit"})]})]})]});case"Done":return(0,a.jsxs)("div",{className:w().load,children:[(0,a.jsx)("h1",{children:"Thank You!"}),(0,a.jsx)(u.default,{href:"/results?id=".concat(t.id),children:(0,a.jsx)("a",{className:k().bigBtn,children:"Go to coaster"})})]});case"Error":return(0,a.jsxs)("div",{className:w().load,children:[(0,a.jsx)("h1",{children:"Something Went Wrong :("}),(0,a.jsx)("button",{className:k().bigBtn,onClick:_,children:"Try again"})]});default:return(0,g.U)(t)}}),[t,x,v,o,b,_])()}var I=function(){return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(o.default,{children:[(0,a.jsxs)("title",{children:["Submit Vote - ",j.sG]}),(0,a.jsx)("meta",{name:"description",content:"Vote on a coaster's seats"})]}),(0,a.jsx)(v.Z,{}),(0,a.jsx)(C.Z,{page:(0,a.jsx)(O,{})}),(0,a.jsx)(x.Z,{isDark:!1})]})}},606:function(e,t,n){"use strict";function r(e){throw new Error("Reached unreachable statement ".concat(e))}n.d(t,{U:function(){return r}})},2601:function(e,t,n){"use strict";function r(e){var t={time:(new Date).getTime()+18e5,token:e};window.sessionStorage.setItem("oauthToken",JSON.stringify(t))}function s(){var e=window.sessionStorage.getItem("oauthToken");if(null===e)return null;var t=JSON.parse(e);return t.time>(new Date).getTime()?t.token:null}n.d(t,{W:function(){return r},v:function(){return s}})},9929:function(e,t,n){"use strict";n.d(t,{sG:function(){return r},QP:function(){return s},Cx:function(){return a}});var r="Coaster Seat Guru",s="https://coasterseatguru.azurewebsites.net/api/",a="707815788715-v292qtutlmval10742tekpbnv2a6to6l.apps.googleusercontent.com"},4525:function(e){e.exports={load:"AuthWrapper_load__E3rg6"}},9841:function(e){e.exports={bigBtn:"BigButton_bigBtn__zurtf"}},2746:function(e){e.exports={main:"Contribute_main__5fPQK",load:"Contribute_load__pL_xj",details:"Contribute_details__0dFDG",subInstr:"Contribute_subInstr___1zAv",progress:"Contribute_progress__XRuP3",active:"Contribute_active__ahOAj"}},3952:function(e){e.exports={footer:"Footer_footer__Tl1eP",dark:"Footer_dark__YTV09"}},5606:function(e){e.exports={header:"Header_header__VYZ3G",img:"Header_img__ndXrS",h1:"Header_h1__Rh9ep",div:"Header_div__ju8k0",a:"Header_a__OpYgW"}},3253:function(e){e.exports={input:"Search_input__jBVVm",results:"Search_results__5GAEo",noResults:"Search_noResults__RG_yA",load:"Search_load__7D_zK",none:"Search_none__strFj",prompt:"Search_prompt__Xe5Gh"}},6934:function(e){e.exports={coaster:"Train_coaster__KhtQW",coasterTrain:"Train_coasterTrain__8ur2O"}},1163:function(e,t,n){e.exports=n(387)},4298:function(e,t,n){e.exports=n(699)}},function(e){e.O(0,[828,774,888,179],(function(){return t=6431,e(e.s=t);var t}));var t=e.O();_N_E=t}]);